//--- Please copy and paste your GitHub Repo on line 2 (optional) ---//
// <GitHub Repo>

// JavaScript Assessment Rubric: https://generation.instructure.com/courses/2342/assignments/143783

// Codecademy: https://www.codecademy.com/paths/front-end-engineer-career-path/tracks/fecp-javascript-syntax-part-iii/modules/fecp-challenge-project-find-your-hat/projects/find-your-hat

// Please break down your thinking process step-by-step (mandatory)
// step 1 :à¸­à¹ˆà¸²à¸™à¹‚à¸ˆà¸—à¸¢à¹Œà¸§à¹ˆà¸² à¹€à¸„à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹ƒà¸«à¹‰à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸à¸¡ à¸•à¸²à¸¡à¸«à¸²à¸«à¸¡à¸§à¸ à¹‚à¸”à¸¢à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸”à¸´à¸™à¸—à¸‡à¹„à¸›à¹€à¸ˆà¸­à¸«à¸¡à¸§à¸à¸ˆà¸°à¸Šà¸™à¸°à¹€à¸à¸¡à¸™à¸µà¹‰ à¹à¸•à¹ˆà¸–à¹‰à¸²à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹„à¸›à¹€à¸ˆà¸­à¸«à¸¥à¸¸à¸¡à¸ˆà¸°à¹à¸žà¹‰ à¹‚à¸”à¸¢à¹€à¸à¸¡à¸™à¸µà¹‰à¹€à¸¥à¹ˆà¸™à¸šà¸™à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡ terminal ,à¸à¸²à¸£à¸šà¸±à¸‡à¸„à¸±à¸š 4à¸—à¸´à¸¨à¸—à¸²à¸‡à¹ƒà¸Šà¹‰à¸à¸²à¸£à¸žà¸´à¸¡à¹€à¸‚à¹‰à¸²à¸—à¸²à¸‡ terminal à¸—à¹‰à¸±à¸‡à¸«à¸¡à¸”
//step 2: à¸œà¸¡à¸—à¸³à¸à¸²à¸£à¸„à¸´à¸”à¸­à¸‡à¸„à¹Œà¸›à¸£à¸°à¸à¸­à¸šà¸‚à¸­à¸‡à¹€à¸à¸¡à¸­à¸­à¸à¸¡à¸²à¸à¹ˆà¸­à¸™à¸§à¹ˆà¸²à¸¡à¸µà¸ªà¹ˆà¸§à¸™à¸›à¸£à¸°à¸à¸­à¸šà¹ƒà¸”à¸šà¹‰à¸²à¸‡ à¸”à¸±à¸‡à¸™à¸µà¹‰            1.map :à¹€à¸›à¹‡à¸™à¸”à¹ˆà¸²à¸™à¸à¸²à¸£à¹€à¸”à¸´à¸™à¸—à¸²à¸‡ Displayà¹€à¸›à¹‡à¸™à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸‚à¸­à¸‡à¸à¸²à¸£à¹€à¸”à¸´à¸™à¸—à¸µà¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¹„à¸› ,à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸‚à¸­à¸‡ holdà¹à¸¥à¸° hat.                                                           2.input direction:4 à¸—à¸´à¸¨à¸—à¸²à¸‡ à¸à¸²à¸£à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸—à¸µà¹ˆ l:à¸‹à¹‰à¸²à¸¢,r:à¸‚à¸§à¸²,u:à¸‚à¸¶à¹‰à¸™,d:à¸¥à¸‡ à¹‚à¸”à¸¢à¸ˆà¸°à¸¡à¸µ curcorà¸¡à¸²à¸£à¸­à¸£à¸±à¸šà¸„à¸³ input
//step3:à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸”à¸ªà¸­à¸šà¸—à¸³à¸ªà¹ˆà¸§à¸™ map à¸à¹ˆà¸­à¸™ à¹‚à¸”à¸¢à¸—à¸”à¸ªà¸­à¸š hardcode Array à¸‚à¸¶à¹‰à¸™à¸¡à¸²à¹€à¸›à¹‡à¸™à¸”à¹‰à¸²à¸™à¸à¹ˆà¸­à¸™à¸ˆà¸²à¸à¸™à¸±à¹‰à¸™à¸—à¸³à¸à¸²à¸£ print map à¸­à¸­à¸à¸¡à¸²à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰à¸§à¸´à¸˜à¸µà¸à¸²à¸£ for loop 2 à¸Šà¸±à¹‰à¸™ à¸Šà¸±à¹‰à¸™1 à¹€à¸›à¹‡à¸™ row à¸›à¸£à¸´à¹‰à¸™à¸­à¸­à¸à¸¡à¸²à¸—à¸µà¹ˆà¸¥à¸°à¹à¸–à¸§ à¸Šà¸±à¹‰à¸™ 2à¹€à¸›à¹‡à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™à¹à¸–à¸§à¸™à¸±à¹‰à¸™à¹† à¹‚à¸”à¸¢à¸ˆà¸°à¸‚à¸¶à¹‰à¸™à¸šà¸£à¸£à¸—à¸±à¸”à¹ƒà¸«à¸¡à¹ˆà¸—à¸¸à¸à¹† row                                 à¸•à¹ˆà¸­à¸¡à¸²à¸—à¸”à¸ªà¸­à¸šà¸£à¸°à¸šà¸š input à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ prompt-sync à¹€à¸›à¹‡à¸™à¸à¸²à¸£à¸£à¸­à¸£à¸±à¸š input à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ à¹‚à¸”à¸¢à¹€à¸à¹‡à¸š input à¹„à¸§à¹‰à¹ƒà¸™à¸•à¸±à¸§à¹à¸›à¸¥à¸™à¸¶à¸‡à¹€à¸žà¸·à¹ˆà¸­à¸™à¸³à¹„à¸›à¹ƒà¸Šà¹‰
//step:4 à¹€à¸£à¸´à¹ˆà¸¡à¸›à¸£à¸°à¸à¸­à¸šà¸£à¹ˆà¸²à¸‡à¸£à¸§à¸¡à¸à¸±à¸™à¹‚à¸”à¸¢à¸—à¸³à¸à¸²à¸£à¹€à¸‚à¸µà¸¢à¸™ class start à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸Šà¹‰à¹ƒà¸™à¸à¸²à¸£à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡ while loop status==trur à¹‚à¸”à¸¢à¹ƒà¸™class start à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸”à¸±à¸‡à¸™à¸µà¹‰                1.class.print map à¸ˆà¸²à¸ array à¸­à¸­à¸à¸¡à¸²à¹€à¸›à¹‡à¸™à¸”à¹ˆà¸²à¸™                                 2.class.control à¸£à¸­à¸£à¸±à¸š à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸à¸²à¸£à¹€à¸”à¸´à¸™ à¹‚à¸”à¸¢à¹à¸šà¹ˆà¸‡à¹€à¸›à¹‡à¸™ 4à¸—à¸´à¸¨à¸—à¸²à¸‡ l:à¸‹à¹‰à¸²à¸¢,r:à¸‚à¸§à¸²,u:à¸‚à¸¶à¹‰à¸™,d:à¸¥à¸‡   à¹€à¸¡à¸·à¹ˆà¸­à¸£à¸±à¸š à¸—à¸´à¸¨à¸—à¸²à¸‡à¸¡à¸²à¹à¸¥à¹‰à¸§ à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸ˆà¸°à¸—à¸³à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸™ position à¸•à¹ˆà¸­à¹„à¸›à¸—à¸µà¹ˆà¹€à¸£à¸²à¹€à¸”à¸´à¸™à¹‚à¸”à¸¢ _copy position à¹„à¸§à¹‰à¹à¸¥à¹‰à¸§à¹€à¸Šà¹‡à¸„à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‡à¸•à¹ˆà¸²à¸‡à¹† à¸§à¹ˆà¸² out of range array à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸à¹‡à¸ˆà¸°à¸—à¸³à¸à¸²à¸£à¹€à¸Šà¹‡à¸„à¸•à¹ˆà¸­à¸§à¹ˆà¸²à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸—à¸µà¹ˆà¸ˆà¸°à¹€à¸”à¸´à¸™à¸•à¹ˆà¸­à¹„à¸›à¸™à¸±à¹‰à¸™à¹€à¸›à¹‡à¸™ object à¸­à¸°à¹„à¸£ à¸–à¹‰à¸²à¹€à¸›à¹‡à¸™à¸žà¸·à¹‰à¸™à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸à¹‡à¸ˆà¸°à¸—à¸³à¸à¸²à¸£ update array map à¸ˆà¸£à¸´à¸‡ à¹à¸•à¹ˆà¸–à¹‰à¸²à¹€à¸›à¹‡à¸™ hold,hat à¹„à¸¡à¹ˆupdate map à¸ˆà¸£à¸´à¸‡à¹à¸¥à¸°à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸ˆà¸°à¸—à¸³à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ status = false à¹€à¸žà¸·à¹ˆà¸­à¸­à¸­à¸



// JS Assessment: Find your hat //

// const prompt = require('prompt-sync')({ sigint: true }); // This sends a SIGINT, or â€œsignal interruptâ€ message indicating that a user wants to exit a program by press Crtl+
 const clear = require('clear-screen');//every turn clear the screen that meant you will not get new field in time you choose the direction
const hat = 'ðŸ¥';
const hole = 'ðŸš§';
const fieldCharacter = 'ðŸŸ©';
const pathCharacter = 'ðŸš‘';

class Field {
  constructor(field = [[]]) {
    this.field = field;
    this.positionX = 0;
    this.positionY = 0;
    this.status = 'true';
    // Set the "home" position before the game starts
    this.field[0][0] = pathCharacter;
  }
  static generateField(height, width, percent = 0.2) {
    let set_hat = true;
    const field = new Array(height).fill(0).map(e => new Array(width));
    for(let y = 0; y < height; y++){
        for(let x = 0; x < width; x++){
            const prob = Math.random();
            field[y][x] = prob > percent ? fieldCharacter : hole
        }
    }
    //set hat
    while(set_hat){
        let ran_y = Math.floor(Math.random()*height);
        let ran_x = Math.floor(Math.random()*width);
        console.log(ran_y + " " + ran_x);
        // let cell = field[ran_y][ran_x];
        if(field[ran_y][ran_x] == fieldCharacter){
            field[ran_y][ran_x] = hat;
            set_hat = false;
        }
    }
    return field;
}
  //print field method to make it eaier 
  printMap() {
    clear(); //clear function 
    // your print map code here
    let row = ""
    for(let i=0;i<=this.field.length-1;i++){
        // console.log(i);
        for(let j=0;j<=this.field[i].length-1;j++){
            row = row.concat(this.field[i][j]);
        }
        row += "\n";
    }
    console.log(row);
  }

  control(){
    const max_index = this.field.length-1;
    const max_index_row = this.field[0].length-1;//dead situation
    let _copy = 0;
    const prompt = require('prompt-sync')({ sigint: true }); // This sends a SIGINT, or â€œsignal interruptâ€ message indicating that a user wants to exit a program by press Crtl+
    let control = prompt("l:Left,r:right,u:up,d:Down?:");
    console.log("Move:" + control);
    //check move
    //this.positionX
    //this.positionY
    console.log(`Now Pos: ${this.positionX}:${this.positionY}`);
    switch(control){
        case 'l':
            _copy = this.positionY;
            _copy -= 1;
            if(_copy < 0){
                //out of min range
                console.log("Out of range: pos < 0")
            }else{
                if(check_object('l',this.positionX,this.positionY,this.field) === fieldCharacter){
                    console.log("true fieldCharacter");
                    this.positionY -= 1;
                    console.log("New: " + this.positionY)
                    this.field[this.positionX][this.positionY] = pathCharacter;
                }
                else if(check_object('l',this.positionX,this.positionY,this.field) === hat){
                    console.log("Find hate");
                    this.status = false;
                }
                else if(check_object('l',this.positionX,this.positionY,this.field) === hole){
                    console.log("Hold end game");
                    this.status = false;
                }
            }
            break;
        case 'r':
            _copy = this.positionY;
            _copy += 1;
            if(_copy > max_index_row){
                //out of min range
                console.log(`Out of range: pos > ${max_index_row}`);
            }else{
                if(check_object('r',this.positionX,this.positionY,this.field) === fieldCharacter){
                    console.log("true fieldCharacter");
                    this.positionY += 1;
                    console.log("New: " + this.positionY)
                    this.field[this.positionX][this.positionY] = pathCharacter;
                }
                else if(check_object('r',this.positionX,this.positionY,this.field) === hat){
                    console.log("Find hate");
                    this.status = false;
                }
                else if(check_object('r',this.positionX,this.positionY,this.field) === hole){
                    console.log("Hold end game");
                    this.status = false;
                }
            }
            break;
        case 'u':
            _copy = this.positionX;
            _copy -= 1;
            if(_copy < 0){
                console.log("Out of range: pos < 0");
            }else{
                if(check_object('u',this.positionX,this.positionY,this.field) === fieldCharacter){
                    console.log("true fieldCharacter");
                    this.positionX -= 1;
                    console.log("New:" + this.positionX);
                    this.field[this.positionX][this.positionY] = pathCharacter;
                }
                else if(check_object('u',this.positionX,this.positionY,this.field) === hat){
                    console.log("Find hate");
                    this.status = false;
                }
                else if(check_object('u',this.positionX,this.positionY,this.field) === hole){
                    console.log("Hold end game");
                    this.status = false;
                }
            }
            break;
        case 'd':
            _copy = this.positionX;
            _copy += 1;
            if(_copy > max_index){
                console.log("Out of range: pos >" +max_index);
            }else{
                if(check_object('d',this.positionX,this.positionY,this.field) === fieldCharacter){
                    console.log("true fieldCharacter");
                    this.positionX += 1;
                    console.log("New:" + this.positionX);
                    this.field[this.positionX][this.positionY] = pathCharacter;
                }
                else if(check_object('d',this.positionX,this.positionY,this.field) === hat){
                    console.log("Find hate");
                    this.status = false;
                }
                else if(check_object('d',this.positionX,this.positionY,this.field) === hole){
                    console.log("Hold end game");
                    this.status = false;
                }
            }
            break;
    }

    function check_object(direction,posx,posy,field){
        let get_posx = posx;
        let get_posy = posy;
        let get_field = field;
        let object_to = "";
        switch(direction){
            case'l':
                object_to = get_field[get_posx][get_posy-1];
                break;
            case'r':
            object_to = get_field[get_posx][get_posy+1];
                break;
            case'u':
                object_to = get_field[get_posx-1][get_posy];
                break;
            case 'd':
                object_to = get_field[get_posx+1][get_posy];
                break;
        }
        return object_to;
    }
  }

  start(){
    while(this.status){
        myField.printMap();
        myField.control();
    }
  }
}

const myField = new Field(Field.generateField(10,10));

// node script.js
myField.start();


// [
//     ['*', 'â–‘', 'O','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'â–‘', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', 'O', 'â–‘','â–‘','â–‘','â–‘'],
//     ['â–‘', '^', 'â–‘','â–‘','â–‘','â–‘'],
   
//   ]

